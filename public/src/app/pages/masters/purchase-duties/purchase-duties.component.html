<div class="row">
  <!-- <div class="col-lg-12">
    <nb-card>
      <nb-card-body>
        <h4>Registration</h4>
      </nb-card-body>
    </nb-card>
  </div>
  <div class="col-lg-12">
    <nb-card>
      <nb-card-body>
          <table>
            <tr>
              <td>Email</td>
              <td><mat-form-field><input type="email" matInput name="email" [(ngModel)]="user.email"></mat-form-field> </td>
            </tr>
            <tr>
              <td>Name</td>
              <td><mat-form-field><input matInput name="userName" [(ngModel)]="user.userName"></mat-form-field> </td>
            </tr>
            <tr>
              <td>Password</td>
              <td><mat-form-field><input type="password" name="password" matInput [(ngModel)]="user.password"></mat-form-field></td>
            </tr>
            <tr>
              <td>Confirm Password</td>
              <td><mat-form-field><input type="password" name="confirmPassword" matInput [(ngModel)]="user.confirmPassword"></mat-form-field></td>
            </tr>
            <tr>
              <td>
                <button mat-raised-button (click)="register()">Submit</button>
              </td>
            </tr>
          </table>
      </nb-card-body>
    </nb-card>
  </div> -->
  <div class="col-lg-12">
    <nb-card>
      <nb-card-header>
        Purchase Duties
      </nb-card-header>
      <nb-card-body>
        <div align="center">
          <mat-form-field class="filter-field">
            <input matInput   placeholder="Filter"   [(ngModel)]="searchTerm" (keyup)="search($event.target.value)">
          </mat-form-field>
          <mat-form-field class="filter-date">
            <input matInput [(ngModel)]="filterStart" [matDatepicker]="pickerStart" (click)="pickerStart.open()" placeholder="From" readonly>
            <mat-datepicker-toggle matSuffix [for]="pickerStart"></mat-datepicker-toggle>
            <mat-datepicker #pickerStart></mat-datepicker>
          </mat-form-field>
          <mat-form-field class="filter-date">
            <input matInput [(ngModel)]="filterEnd" [matDatepicker]="pickerEnd" (click)="pickerEnd.open()" placeholder="To" readonly>
            <mat-datepicker-toggle matSuffix [for]="pickerEnd"></mat-datepicker-toggle>
            <mat-datepicker #pickerEnd></mat-datepicker>
          </mat-form-field>
          <button mat-icon-button (click)="searchByDate()"><mat-icon class="filter-icon">search</mat-icon></button>
          <button mat-icon-button (click)="clear()"><mat-icon class="filter-icon">highlight_off</mat-icon></button>
        </div>
        <mat-table #table [dataSource]="dataSource" matSort>          

          <ng-container matColumnDef="date">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Date</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.startDate | date: 'dd-MM-yyyy'}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="dutyId">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Duty ID</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.id}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="supplier">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Supplier</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.sname}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="customer">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Customer</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.cname}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="passenger">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Passenger</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.passenger}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="vehicle">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Vehicle</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.vehicle}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="dutyType">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Duty Type</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.dutyType}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="status">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Status</mat-header-cell>
            <mat-cell *matCellDef="let element">
              <mat-chip-list>
                <mat-chip color="primary" selected="true">{{element.status}}</mat-chip>
              </mat-chip-list> 
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="estCustAmt">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Aprox. Cust. Amt.</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.price}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="estAmt">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Aprox. Amt.</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.supplier}}</mat-cell>
          </ng-container>

          <!-- <ng-container matColumnDef="earnings">
            <mat-header-cell *matHeaderCellDef>Earnings</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.supplier}}</mat-cell>
          </ng-container> -->

          <ng-container matColumnDef="supplierInvoice">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Supplier Invoice</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.supplier}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="Options">
            <mat-header-cell *matHeaderCellDef> Options</mat-header-cell>
            <mat-cell *matCellDef="let element ;let row" (click)="$event.stopPropagation()">
              <button mat-icon-button [matMenuTriggerFor]="menu"><mat-icon>more_vert</mat-icon></button>
              <mat-menu #menu="matMenu">
                <!-- <button mat-menu-item (click)="viewInvoice(row)">View</button> -->
                <!-- <button (click)="" mat-menu-item>Edit</button>
                <button (click)="" mat-menu-item>Generate Custom Duty Slip</button> -->
                <!-- <button (click)="sendDutySlip(row)" mat-menu-item>Send Duty Slip</button> -->
                <button (click)="viewDutySlip(row)" mat-menu-item>View Duty Slip</button>
                <button *ngIf="row.status=='Completed' && permission.closeDuty" mat-menu-item (click)="openCloseDuty(row)">Edit Duty Slip</button>
                <button *ngIf="permission.requestInvoice" (click)="requestInvoice(row)" mat-menu-item>Request Invoice</button>
                <button *ngIf="permission.requestDutySlip" (click)="requestDutySlip(row)" mat-menu-item>Request Duty Slip</button>
              </mat-menu>
            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns;" (click)="viewInvoice(row)"></mat-row> 
                    
        </mat-table>
        <mat-paginator [length]="length"
              [pageSize]="pageSize"
              [pageSizeOptions]="pageSizeOptions">
          </mat-paginator>
      </nb-card-body>
    </nb-card>
  </div>
</div>